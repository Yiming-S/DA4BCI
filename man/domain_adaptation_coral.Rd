% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/coral.R
\name{domain_adaptation_coral}
\alias{domain_adaptation_coral}
\title{Correlation Alignment (CORAL)}
\usage{
domain_adaptation_coral(source_data, target_data, lambda = 1e-05)
}
\arguments{
\item{source_data}{A numeric matrix representing the source domain, where rows
correspond to observations and columns to features.}

\item{target_data}{A numeric matrix representing the target domain, with the
same number of columns as \code{source_data}.}

\item{lambda}{A small positive scalar (default = 1e-5) added to the diagonal of
both source and target covariance matrices to stabilize their inverses in
high-dimensional or limited-sample cases.}
}
\value{
A list containing:
\describe{
\item{\code{weighted_source_data}}{The transformed (whitened + recolored) source data
so that its covariance now matches that of the target domain.}
\item{\code{target_data}}{The original target data, returned for convenience.}
}
}
\description{
The \code{domain_adaptation_coral} function aligns the covariance structure of
source and target data by first “whitening” the source data, then “re-coloring”
it using the target covariance matrix. This unsupervised procedure helps reduce
domain shifts by matching second-order statistics (covariances) of the two datasets.
}
\examples{
# Example usage:
set.seed(123)
src <- matrix(rnorm(100), nrow = 20, ncol = 5)
tgt <- matrix(rnorm(100, mean = 2), nrow = 20, ncol = 5)

# Perform CORAL to align source data to target
res_coral <- domain_adaptation_coral(src, tgt, lambda = 1e-5)
aligned_src <- res_coral$weighted_source_data

# Check covariances before/after
cat("Cov of target:\n")
print(cov(tgt))
cat("Cov of aligned source:\n")
print(cov(aligned_src))

}
