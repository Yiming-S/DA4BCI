% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/kernels_metrics.R
\name{compute_mahalanobis}
\alias{compute_mahalanobis}
\title{Mahalanobis distance between two datasets (means with pooled/selected covariance)}
\usage{
compute_mahalanobis(
  source,
  target,
  covChoice = c("pooled", "source", "target"),
  shrinkage_alpha = NULL,
  ridge = 1e-06,
  squared = FALSE
)
}
\arguments{
\item{source}{Numeric matrix (n_s × p): source samples.}

\item{target}{Numeric matrix (n_t × p): target samples.}

\item{covChoice}{Character, one of c("pooled","source","target"); default "pooled".}

\item{shrinkage_alpha}{Optional scalar in \link{0,1}; shrinkage toward spherical target
(tr(S)/p) * I. Use small values like 0.05 ~ 0.2 if n is small or p is large.}

\item{ridge}{Nonnegative scalar ridge added as (ridge * tr(S)/p) * I. Default 1e-6.}

\item{squared}{Logical; if TRUE, return squared distance. Default FALSE.}
}
\value{
A single numeric distance (Mahalanobis) between the two domains.
}
\description{
compute_mahalanobis measures the distance between the source and target
mean vectors under a Mahalanobis metric induced by a chosen covariance
(pooled/source/target). It includes optional shrinkage and a small ridge
for numerical stability in medium/high dimensions.
}
\examples{
\dontrun{
  set.seed(1)
  X <- matrix(rnorm(200), 20, 10)
  Y <- matrix(rnorm(150, 0.5), 15, 10)
  compute_mahalanobis(X, Y)                         # pooled covariance
  compute_mahalanobis(X, Y, covChoice = "source")   # source covariance
  compute_mahalanobis(X, Y, shrinkage_alpha = 0.1)  # mild shrinkage
}
}
